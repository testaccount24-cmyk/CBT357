//-YOUR-USERID-D JOB  (-YOUR-ACCT-INFO-),'-YOUR-NAME-',
//             CLASS=2,MSGCLASS=X,NOTIFY=-YOUR-USERID-
//***
//***  DYNAMIC ALLOCATION THROUGH IBM MODULE
//***
//C          EXEC     PGM=IEL0AA,REGION=4M,
//             PARM=('AG,A,NCT,ESD,F(I),NOFLOW,NIS,NOLIST,M,NMI,NEST',
//             'MAP,OF,OPT(TIME),OP,SZ(MAX),S,STMT,STG,X(F)')
//STEPLIB      DD       DISP=SHR,DSN=-YOUR-PLI-LIB-

 DYNALLOC: PROC OPTIONS(MAIN) REORDER;

    DCL  INFILE    FILE RECORD SEQUENTIAL INPUT;
    DCL  SYSPRINT  FILE;
    DCL  INREC     CHAR(32760) STATIC VARYING INIT('');
    DCL  ALLOC_STR CHAR(00100) STATIC VARYING INIT('');
    DCL  EOF       CHAR(00001) STATIC         INIT('N');
    DCL  PLIRETV   BUILTIN;
    DCL  BPXWDYN   EXTERNAL ENTRY OPTIONS(ASM INTER RETCODE);

    ON ENDFILE(INFILE) EOF = 'Y';

    ALLOC_STR = 'ALLOC DD(INFILE) SHR DSN(''-YOUR-SYSLIB-(JOB)'')';
    FETCH BPXWDYN;
    CALL BPXWDYN(ALLOC_STR);
    IF PLIRETV() = 0
       THEN DO;
          OPEN FILE(INFILE);
          READ FILE(INFILE) INTO(INREC);
          DO WHILE (EOF='N');
             PUT SKIP LIST(INREC);
             READ FILE(INFILE) INTO(INREC);
          END;
       END;
       ELSE DO;
          PUT SKIP LIST('DYNALLOC FAILED, RC WAS ', PLIRETV());
       END;
 END DYNALLOC;

//SYSUT1       DD       UNIT=VIO,
//             SPACE=(CYL,(05,02),,CONTIG)
//SYSPRINT     DD       SYSOUT=*
//SYSLIN       DD       DSN=&&LOADSET,DISP=(MOD,PASS),
//             UNIT=VIO,SPACE=(CYL,(05,02))
//***
//GO         EXEC     PGM=LOADER,PARM='MAP,PRINT//...',
//             REGION=4M,COND=(5,LT)
//SYSLIB       DD       DISP=SHR,DSN=-YOUR-SCEELLED-
//SYSLIN       DD       DSN=&&LOADSET,DISP=(OLD,DELETE,DELETE)
//SYSLOUT      DD       SYSOUT=*
//SYSPRINT     DD       SYSOUT=*
//***
