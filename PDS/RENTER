         MACRO
&NAME    RENTER  &BASEREG=R11,&SALEN=108,&REGS=YES
         GBLC  &SASIZE
&SASIZE  SETC  '&SALEN'
.* THIS MACRO PROVIDES ENTRY CODE FOR A REENTRANT PROGRAM.
.* THE DEFAULT BASE REGISTER IS 11 BUT MAY BE CHANGED VIA
.* THE BASEREG PARAMETER.  THE SAVE AREA SIZE MAY BE SET
.* THROUGH THE SALEN PARAMETER AND DEFAULTS TO 108.
         AIF   ('&REGS' NE 'YES').NOREGS
         REGS
.NOREGS  ANOP
&NAME    CSECT
         STM   R14,R12,12(R13)     SAVE INCOMING REGS
         LR    &BASEREG(1),R15     ESTABLISH ADDRESSABILITY
&#BR     SETA  N'&BASEREG
         AIF   (&#BR GT 1).MULTIRG
         USING &NAME,&BASEREG
         AGO   .OUTBASE
.MULTIRG ANOP
&#BRX    SETA  1
&#BRY    SETA  2
         LA    &BASEREG(&#BR),4095
.LOADNXT LA    &BASEREG(&#BRY),1(&BASEREG(&#BRX),&BASEREG(&#BR))
&#BRX    SETA  &#BRX+1
&#BRY    SETA  &#BRY+1
         AIF   (&#BRY LE &#BR).LOADNXT
&BASELEN SETA  K'&BASEREG-2
&BASES   SETC  '&BASEREG'(2,&BASELEN)
         USING &NAME,&BASES
.OUTBASE ANOP
         LA    R0,&SASIZE          LOAD SAVE AREA SIZE FOR GETMAIN
         STORAGE  OBTAIN,LENGTH=(0),LOC=BELOW
         ST    R1,8(R13)           STORE ADDRESS OF NEW SAVE AREA
         ST    R13,4(R1)           SAVE CALLERS SAVE AREA ADDRESS
         LM    R0,R1,20(R13)       RELOAD R0 & R1
         L     R13,8(R13)          LOAD NEW SAVE AREA ADDRESS INTO R13
         MEND
