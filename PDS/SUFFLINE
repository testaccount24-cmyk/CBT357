/**  REXX -- SUFF -- WILL SUFFIX LINES WITH A CHARACTER STRING  **/
   ADDRESS ISREDIT "MACRO (PARM1) NOPROCESS"
   IF RC > 0 THEN DO
      SIGNAL NOT_IN_EDIT
      SAY "THIS IS AN EDIT MACRO"
      EXIT
   END

   IF PARM1 = "" | PARM1 = "?"  THEN SIGNAL DISPDOC

   ADDRESS ISREDIT "(TYPE) = PROFILE"

   PARM1 = TRANSLATE(PARM1)
   IF PARM1 = "QUOTE"       THEN PARM1 = '"'
   IF PARM1 = "APOSTROPHE"  THEN PARM1 = "'"
   IF PARM1 = "APOST"       THEN PARM1 = "'"
   IF PARM1 = "COMMA"       THEN PARM1 = ","

   ADDRESS ISPEXEC
   'CONTROL ERRORS RETURN'
   'ISREDIT PROCESS RANGE C  '
   SELECT
      WHEN RC = 0 THEN DO
         'ISREDIT (CMD) = RANGE_CMD'
         'ISREDIT (LINE1) = LINENUM .ZFRANGE'
         'ISREDIT (LINE2) = LINENUM .ZLRANGE'
         LINESTOCUT = LINE2 - LINE1 + 1
      END
      WHEN RC <= 4 THEN DO                      /* NO C OR M ENTERED */
         'ISREDIT (LINE1) = LINENUM .ZFRANGE'
         'ISREDIT (LINE2) = LINENUM .ZLRANGE'
         LINESTOCUT = LINE2 - LINE1 + 1
      END
      OTHERWISE  /* LINE COMMAND CONFLICT - EDIT WILL CREATE MESSAGE */
          EXIT 12
   END  /* SELECT */

/* PUT THE LINES IN STEM VARBLE */
   CUTCNT = 0  /* CHANGE LATER */
   DO I = LINE1 TO LINE2
      CUTCNT = CUTCNT + 1
      'ISREDIT (CL'CUTCNT') = LINE' I
      'ISREDIT (CURLINE) = LINE' I
      NEWLINE = CURLINE
      IF NEWLINE = COPIES(" ",LENGTH(NEWLINE)) THEN DO
         NEWLENGTH = LENGTH(NEWLINE) - LENGTH(PARM1)
      END
      ELSE DO
         NEWLINE = REVERSE(NEWLINE)
         PARM1R  = REVERSE(PARM1)
         DO I2 = 1 TO LENGTH(NEWLINE)
            IF SUBSTR(NEWLINE,I2,1) <> " " THEN DO
               NEWLINE = COPIES(" ",I2-1)""PARM1R""SUBSTR(NEWLINE,I2)
               LEAVE I2
            END
         END I2
      NEWLINE = REVERSE(NEWLINE)
      END
      "ISREDIT LINE" I "= (NEWLINE)"
      CL.0 = CUTCNT
   END I
   EXIT(0)

BAD_INPUT:
   ZEDSMSG = "PARM MISSING"
   ZEDLMSG = "RE-EXECUTE FROM COMMAND LINE: SUFF CHARACTER-TO-SUFFIX"
   ADDRESS ISPEXEC "SETMSG MSG(ISRZ001)"
   EXIT(1)

NOT_IN_EDIT:
   ZEDSMSG = "NOT IN ISPF EDIT"
   ZEDLMSG = "THIS MUST BE EXECUTED WHILE IN ISPF EDIT AS A MACRO. "
   ADDRESS ISPEXEC "SETMSG MSG(ISRZ001)"
   EXIT(1)

DISPDOC:
   ADDRESS TSO "CLEAR"
   SAY "                                                             "
   SAY "  SUFFLINE  APPENDS A STRING TO THE END OF EVERY SELECTED    "
   SAY "            LINE (VIA C/CC/C#) OR TO EVERY LINE IN THE FILE. "
   SAY "                                                             "
   SAY "     IF YOU WANT TO SUFFIX WITH A QUOTE, USE THE WORD        "
   SAY "     QUOTE; IF YOU WANT TO SUFFIX WITH AN APOSTROPHE,        "
   SAY "     USE THE WORD APOST; IF YOU WANT TO SUFFIX WITH A        "
   SAY "     COMMA, USE THE WORD COMMA.                              "
   SAY
   SAY "     FOR EXAMPLE,                                            "
   SAY "        SUFFLINE |                                           "
   SAY "     WILL APPEND A VERTICAL BAR TO THE END OF EACH LINE.     "
   SAY
   EXIT(1)

